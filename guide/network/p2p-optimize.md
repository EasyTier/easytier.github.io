# P2P 优化

如果您希望 EasyTier 更容易地与其他 EasyTier 节点建立 P2P 连接，可以通过以下方式进行优化。

## IPv6

EasyTier 支持节点间通过 IPv6 进行 P2P 通信，默认 EasyTier 会监听一个 Ipv6 的 TCP 和 UDP 的 11010 端口。

如果您的节点都拥有 IPv6 地址，并且可以入站（即被外网访问），就可以非常容易建立 P2P 连接。

如果您的节点都拥有 IPv6 地址，但不可入站（即不能被外网访问），可以利用 Easytier（版本2.3.0以上） 的 IPv6 打洞功能进行 P2P 连接，默认情况下开启此功能。

当然如果您能够修改 IPv6 的防火墙使其可以入站，也可以大幅度提高 p2p 的成功几率。

如果您的 IPv6 使用了 NAT66 技术，即网络地址转换技术，可以参考 IPv4 部分，如果可以的话建议关闭 NAT66 技术。

## IPv4

EasyTier 支持节点间通过 IPv4 进行 P2P 通信，默认 EasyTier 会监听一个 Ipv4 的 TCP 和 UDP 的 11010 端口。

如果您的节点拥有公网 IPv4 地址，并且可以入站（即被外网访问），就可以非常容易建立 P2P 连接。

如果您的节点是普通家庭宽带，无公网 IPv4 ，需要修改 NAT 类型来提高 P2P 的成功几率，分为以下几种情况：



## 指定公网 IP 和端口

某些情况下，节点拥有公网的 IP 和 端口，但 EasyTier 无法正确识别 (比如 NAT 主机)，可以使用 `--mapped-listeners` 配置公网 IP 和端口。 例如：

```sh
easytier-core --mapped-listeners tcp://8.8.8.8:12345 -l tcp://0.0.0.0:11010
```

该 EasyTier 实例监听本地的 11010 TCP 端口，且该端口被映射到公网的 12345 端口。其他节点会尝试连接到公网的 12345 端口。

## 关闭上网辅助工具

一些上网辅助工具会影响 STUN 测试的结果，导致 EasyTier 无法识别 NAT 类型，或者识别到错误的公网 IP 和端口。可以尝试关闭这些工具。
